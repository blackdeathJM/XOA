<ng-container *ngIf="!_clientesState.cargando; else cargando">
    <p-table [value]="_clientesState.state$ | async" dataKey="nombreCompleto" [rowHover]="true" class="p-datatable-striped">
        <ng-template pTemplate="header">
            <tr>
                <th class="yellow-fg" [colSpan]="5">Nombre completo</th>
                <th class="yellow-fg">Telefonos</th>
                <th class="yellow-fg" [style]="{width: '150px'}">Contratos</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-cliente let-expanded="expanded">
            <tr>
                <td class="amber-fg" [colSpan]="5">{{cliente.nombreCompleto}}</td>
                <td class="amber-fg">{{cliente.telefonos}}</td>
                <td [ngStyle]="{width: '150px'}">
                    <button mat-icon-button class="green-fg" [pRowToggler]="cliente">
                        <mat-icon>{{expanded ? 'arrow_downward' : 'arrow_forward'}}</mat-icon>
                    </button>
                    <button mat-icon-button class="white-fg" (click)="nvaSolicitudServAgua(cliente)" matTooltip="Crear nueva solicitud de servicio">
                        <mat-icon>note_add</mat-icon>
                    </button>
                    <button mat-icon-button color="warn" matTooltip="solicitudes de servicio creadas" (click)="verSolicitudesCreadas(cliente)">
                        <mat-icon>assignment_late</mat-icon>
                    </button>
                </td>
            </tr>
        </ng-template>
        <ng-template pTemplate="rowexpansion" let-cliente>
            <tr>
                <td [colSpan]="7">
                    <app-prime-tabla
                        [accionesVisibles]="true"
                        [btnAcciones]="acciones"
                        [columnas]="columnas"
                        [valConsulta]="cliente.contratos"
                        [ancho]="{width: '80px'}">
                    </app-prime-tabla>
                    <mat-divider class="m-5"></mat-divider>
                    <app-detalle-contrato></app-detalle-contrato>
                </td>
            </tr>
        </ng-template>
    </p-table>
</ng-container>

<ng-template #cargando>
    <app-lista-cargando></app-lista-cargando>
</ng-template>